/* @license GNU-GPL-2.0-or-later https://www.drupal.org/licensing/faq */
(function($,Drupal,once){function removeDestinationParameter(){once('removeDestinationParameter','html').forEach(()=>{$(document).on('drupalContextualLinkAdded',function(event,data){let $subPage=data.$el.find('li.add-subpage');if($subPage.length){let $link=$subPage.find('a');let url=new URL($link.attr('href'),window.location.origin);url.searchParams.delete('destination');$link.attr('href',decodeURIComponent(url.toString()));}let $outline=data.$el.find('li.outline');if($outline.length){let $link=$outline.find('a');let url=new URL($link.attr('href'),window.location.origin);let pathName=url.pathname;var word='/outline';var newWord='/book-outline';var n=pathName.lastIndexOf(word);url.pathname=pathName.slice(0,n)+pathName.slice(n).replace(word,newWord);url.searchParams.delete('destination');$link.attr('href',decodeURIComponent(url.toString()));}let $deleteLink=data.$el.find('li.entitynodedelete-form');if($deleteLink.length){let $link=$deleteLink.find('a');let url=new URL($link.attr('href'),window.location.origin);let params=url.searchParams.getAll('destination');if(params.length===2){params.pop();url.searchParams.set('destination',params[0]);$link.attr('href',decodeURIComponent(url.toString()));}}let $subPageDeleteLink=data.$el.find('li.subpage-delete-link');if($subPageDeleteLink.length){let $link=$subPageDeleteLink.find('a');let url=new URL($link.attr('href'),window.location.origin);url.searchParams.delete('destination');let newDestination=url.searchParams.get('new_destination');url.searchParams.delete('new_destination');url.searchParams.set('destination',newDestination);$link.attr('href',decodeURIComponent(url.toString()));}});});}Drupal.behaviors.osPagesContextualChanges={attach:function(context,settings){removeDestinationParameter();}};})(jQuery,Drupal,once);;
(function($,Drupal,drupalSettings,once){function alterDeleteDestination($el,redirectLocation){let $link=$el.find('a');let url=new URL($link.attr('href'),window.location.origin);let newDestination=drupalSettings.spaces.url+redirectLocation;url.searchParams.set('destination',newDestination);$link.attr('href',decodeURIComponent(url.toString()));}function alterEditDestination($el){let $link=$el.find('a');let url=new URL($link.attr('href'),window.location.origin);var url_value=$link.attr('href');if(url_value.match('/node/'))url.searchParams.delete('destination');if(drupalSettings.entitySetting.type==='bibcite_reference')if(drupalSettings.entitySetting.viewmode==='teaser'){let destination=window.location.href;destination=destination.replace(window.location.origin,"");url.searchParams.set('destination',destination);}else url.searchParams.delete('destination');$link.attr('href',decodeURIComponent(url.toString()));}function init(){if(drupalSettings.spaces!==undefined)registerDrupalContextualLinkAddedEvent();}function registerDrupalContextualLinkAddedEvent(){once('registerDrupalContextualLinkAddedEvent','html').forEach(function(){$(document).bind('drupalContextualLinkAdded',function(event,data){let $deleteOption=data.$el.find('li.entitynodedelete-form, li.entitybibcite-referencedelete-form, li.paragraphs-editdelete-form');if($deleteOption.length){let entityMapping=drupalSettings.entitySetting.mapping[drupalSettings.entitySetting.type];let bundle=drupalSettings.entitySetting.bundle;if(drupalSettings.entitySetting.type==='bibcite_reference')bundle='*';let redirectLocation=entityMapping[bundle];alterDeleteDestination($deleteOption,redirectLocation);}let $editOption=data.$el.find('li.entitynodeedit-form, li.entitybibcite-referenceedit-form, li.paragraphs-editedit-form');if($editOption.length)alterEditDestination($editOption);});});}Drupal.behaviors.vsiteContextualFullView={attach:function(){init();}};})(jQuery,Drupal,drupalSettings,once);;
(function($){var prototype=Drupal.tableDrag.prototype;Drupal.tableDrag=function(table,tableSettings){var self=this;var $table=$(table);this.$table=$(table);this.table=table;this.tableSettings=tableSettings;this.dragObject=null;this.rowObject=null;this.oldRowElement=null;this.oldY=0;this.changed=false;this.maxDepth=0;this.rtl=$(this.table).css('direction')==='rtl'?-1:1;this.striping=$(this.table).data('striping')===1;this.scrollSettings={amount:4,interval:50,trigger:70};this.scrollInterval=null;this.scrollY=0;this.windowHeight=0;this.$toggleWeightButton=null;this.indentEnabled=false;for(var group in tableSettings)if(tableSettings.hasOwnProperty(group))for(var n in tableSettings[group])if(tableSettings[group].hasOwnProperty(n)){if(tableSettings[group][n].relationship==='parent')this.indentEnabled=true;if(tableSettings[group][n].limit>0)this.maxDepth=tableSettings[group][n].limit;}if(this.indentEnabled){this.indentCount=1;var indent=Drupal.theme('tableDragIndentation');var testRow=$('<tr/>').addClass('draggable').appendTo(table);var testCell=$('<td/>').appendTo(testRow).prepend(indent).prepend(indent);var $indentation=testCell.find('.js-indentation');this.indentAmount=$indentation.get(1).offsetLeft-$indentation.get(0).offsetLeft;testRow.remove();}$table.find('> tr.draggable, > tbody > tr.draggable').each(function(){self.makeDraggable(this);});self.$toggleWeightButton=$(Drupal.theme('btn-sm',{'class':['tabledrag-toggle-weight'],'data-drupal-selector':['tabledrag-toggle-weight'],title:Drupal.t('Re-order rows by numerical weight instead of dragging.'),'data-toggle':'tooltip'}));self.$toggleWeightButton.on('click',$.proxy(function(e){e.preventDefault();this.toggleColumns();},this)).wrap('<div class="tabledrag-toggle-weight-wrapper"></div>').parent();$table.before(self.$toggleWeightButton);self.initColumns();$(document).on('touchmove',function(event){return self.dragRow(event.originalEvent.touches[0],self);});$(document).on('touchend',function(event){return self.dropRow(event.originalEvent.touches[0],self);});$(document).on('mousemove pointermove',function(event){return self.dragRow(event,self);});$(document).on('mouseup pointerup',function(event){return self.dropRow(event,self);});$(window).on('storage',$.proxy(function(e){if(e.originalEvent.key==='Drupal.tableDrag.showWeight'){showWeight=JSON.parse(e.originalEvent.newValue);this.displayColumns(showWeight);}},this));};Drupal.tableDrag.prototype=prototype;Drupal.tableDrag.prototype.makeDraggable=function(item){var self=this;var $item=$(item);$item.find('td:first-of-type').find('a').addClass('menu-item__link');var handle=$('<a href="#" class="tabledrag-handle"/>');var $indentationLast=$item.find('td:first-of-type').find('.js-indentation').eq(-1);if($indentationLast.length){$indentationLast.after(handle);self.indentCount=Math.max($item.find('.js-indentation').length,self.indentCount);}else $item.find('td').eq(0).prepend(handle);handle.attr('title',Drupal.t('Drag to re-order')).attr('data-toggle','tooltip').append(Drupal.theme('bootstrapIcon','move'));;handle.on('mousedown touchstart pointerdown',function(event){event.preventDefault();if(event.originalEvent.type==='touchstart')event=event.originalEvent.touches[0];self.dragStart(event,self,item);});handle.on('click',function(e){e.preventDefault();});handle.on('focus',function(){self.safeBlur=true;});handle.on('blur',function(event){if(self.rowObject&&self.safeBlur)self.dropRow(event,self);});handle.on('keydown',function(event){if(event.keyCode!==9&&!self.rowObject)self.rowObject=new self.row(item,'keyboard',self.indentEnabled,self.maxDepth,true);var keyChange=false;var groupHeight;switch(event.keyCode){case 37:case 63234:keyChange=true;self.rowObject.indent(-1*self.rtl);break;case 38:case 63232:var $previousRow=$(self.rowObject.element).prev('tr:first-of-type');var previousRow=$previousRow.get(0);while(previousRow&&$previousRow.is(':hidden')){$previousRow=$(previousRow).prev('tr:first-of-type');previousRow=$previousRow.get(0);}if(previousRow){self.safeBlur=false;self.rowObject.direction='up';keyChange=true;if($(item).is('.tabledrag-root')){groupHeight=0;while(previousRow&&$previousRow.find('.js-indentation').length){$previousRow=$(previousRow).prev('tr:first-of-type');previousRow=$previousRow.get(0);groupHeight+=$previousRow.is(':hidden')?0:previousRow.offsetHeight;}if(previousRow){self.rowObject.swap('before',previousRow);window.scrollBy(0,-groupHeight);}}else{if(self.table.tBodies[0].rows[0]!==previousRow||$previousRow.is('.draggable')){self.rowObject.swap('before',previousRow);self.rowObject.interval=null;self.rowObject.indent(0);window.scrollBy(0,-parseInt(item.offsetHeight,10));}}handle.trigger('focus');}break;case 39:case 63235:keyChange=true;self.rowObject.indent(self.rtl);break;case 40:case 63233:var $nextRow=$(self.rowObject.group).eq(-1).next('tr:first-of-type');var nextRow=$nextRow.get(0);while(nextRow&&$nextRow.is(':hidden')){$nextRow=$(nextRow).next('tr:first-of-type');nextRow=$nextRow.get(0);}if(nextRow){self.safeBlur=false;self.rowObject.direction='down';keyChange=true;if($(item).is('.tabledrag-root')){groupHeight=0;var nextGroup=new self.row(nextRow,'keyboard',self.indentEnabled,self.maxDepth,false);if(nextGroup){$(nextGroup.group).each(function(){groupHeight+=$(this).is(':hidden')?0:this.offsetHeight;});var nextGroupRow=$(nextGroup.group).eq(-1).get(0);self.rowObject.swap('after',nextGroupRow);window.scrollBy(0,parseInt(groupHeight,10));}}else{self.rowObject.swap('after',nextRow);self.rowObject.interval=null;self.rowObject.indent(0);window.scrollBy(0,parseInt(item.offsetHeight,10));}handle.trigger('focus');}break;}if(self.rowObject&&self.rowObject.changed===true){$(item).addClass('drag');if(self.oldRowElement)$(self.oldRowElement).removeClass('drag-previous');self.oldRowElement=item;if(self.striping===true)self.restripeTable();self.onDrag();}if(keyChange)return false;});handle.on('keypress',function(event){switch(event.keyCode){case 37:case 38:case 39:case 40:return false;}});};Drupal.tableDrag.prototype.row.prototype.markChanged=function(){var $cell=$('td:first',this.element);var $target=$($cell.find('.file-size').get(0)||$cell.find('.file').get(0)||$cell.find('.tabledrag-handle').get(0));if(!$cell.find('.tabledrag-changed').length)$target.after(' '+Drupal.theme('tableDragChangedMarker')+' ');};$.extend(Drupal.theme,{tableDragChangedMarker:function(){return Drupal.theme('bootstrapIcon','warning-sign',{'class':['tabledrag-changed','text-warning']});},tableDragChangedWarning:function(){return '<div class="tabledrag-changed-warning alert alert-sm alert-warning messages warning">'+Drupal.theme('tableDragChangedMarker')+' '+Drupal.t('You have unsaved changes.')+'</div>';}});})(jQuery);;
(function($,Drupal){'use strict';Drupal.behaviors.os_widgets_follow_me={attach:function(ctx,drupalSettings){if($('#follow-links-list',ctx).length==0)return;var $form=$('.os-widgets-follow-me-form'),template='<tr class="draggable">'+$('input[name="links[blank][title]"]').parents('tr').hide().html()+'</tr>',tableDrag=Drupal.tableDrag['follow-links-list'],count=$('input[type="hidden"][name="count"]'),new_id=parseInt(count.val());$('.add_new',$form).click(function(e){e.preventDefault();var edit_link_to_add=$('.edit-link-to-add',$form),patt=/^https?:\/\/([^\/]+)/,val=edit_link_to_add.val(),matches=patt.exec(val),new_row,id,i,fd,weight=0;if(val==='')return;if(matches!=null){var domain=matches[1],domains=drupalSettings.follow_networks;for(i in domains){fd=domains[i];if(domain.indexOf(fd.domain)!=-1){domain=i;break;}}if(domain!=matches[1]){id=new_id++;new_row=$(template.replace(/blank/g,id));count.val(parseInt(count.val())+1);$('.field-weight',$form).each(function(){var weight_val=$(this).val();if(weight_val>weight)weight=parseInt(weight_val);});var field_weight=$('.default-weight',new_row);var edit_link=$('#edit-links-'+id+'-weight',new_row);var title=domains[i]['title'];$('span.rrssb-text',new_row).text(val);$('li',new_row).addClass('rrssb-'+domain);$('input[name="links['+id+'][title]"]',new_row).val(title);$('input[name="links['+id+'][domain]"]',new_row).val(val);field_weight.addClass('field-weight').val(weight+1);field_weight.parents('div').css('display','none');edit_link.addClass('field-weight').val(weight+1);edit_link.parents('div').css('display','none');$('table tbody',$form).append(new_row);new_row=$('input[name="links['+id+'][title]"]',$form).parents('tr');setup_remove(new_row);tableDrag.makeDraggable(new_row[0]);$form=$('.os-widgets-follow-me-form');}else alert(Drupal.t(' @val is not from a valid social media domain.',{'@val':val}));}else alert(Drupal.t(' @val is not from a valid social media domain.',{'@val':val}));edit_link_to_add.val('');});function setup_remove(ctx){$('.remove',ctx).click(function(){var $this=$(this);$this.parents('tr').remove();count.val(parseInt(count.val())-1);return false;});}setup_remove($form);}};})(jQuery,Drupal);;
